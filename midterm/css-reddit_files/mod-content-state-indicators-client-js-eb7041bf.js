import{j as t,fY as e,bA as s,bb as o,p as n,h as a,x as i,i as r,c as d,_ as c,n as p,s as u,e as l,q as h,D as m,ek as b,d as g,f as z,bg as S,$ as y,aq as k,r as v,S as I,u as f,ab as R,ac as U,g as C,a0 as w}from"./shell-e94b58e1.js";import{m as P}from"./icon-notification-off-outline-12869169.js";let $=class extends(t(u)){constructor(){super(...arguments),this.status=e.Reported,this.handlePostUpdate=({postId:t,action:o,value:n})=>{t===this.thingId&&o===s.ignoreReports&&(this.status=n?e.Ignored:e.Dismissed)},this.handleCommentUpdate=({commentId:t,action:s,value:n})=>{t===this.thingId&&s===o.ignoreReports&&(this.status=n?e.Ignored:e.Dismissed)}}connectedCallback(){super.connectedCallback(),this.subscribe(n.PostUpdated,this.handlePostUpdate),this.subscribe(n.CommentUpdated,this.handleCommentUpdate)}disconnectedCallback(){super.disconnectedCallback(),this.unsubscribe(n.PostUpdated,this.handlePostUpdate),this.unsubscribe(n.CommentUpdated,this.handleCommentUpdate)}getStyle(){return a({"--list-icon-color":this.status===e.Reported?"var(--shreddit-color-mods-reported-onBackground)":"var(--color-secondary-onBackground)"})}render(){return this.status===e.Reported?i`<div \n class="bg-mods-reported-background hover:bg-mods-reported-background-hover" \n style="${this.getStyle()}" \n>\n <slot></slot>\n </div>`:i`<details \n class="max-w-fit bg-secondary-background hover:bg-secondary-background-hover" \n style="${this.getStyle()}" \n>\n <summary class="cursor-pointer block list-none" @click="${t=>t.stopPropagation()}">\n <slot name="${this.status}"></slot>\n </summary>\n <slot></slot>\n </details>`}};$.styles=[r`summary::-webkit-details-marker{display:none}`,d],c([p({type:String,attribute:"thing-id"})],$.prototype,"thingId",void 0),c([p({type:String})],$.prototype,"status",void 0),$=c([l("reports-summary-wrapper")],$);const x=h(u);let A=class extends x{constructor(){super(...arguments),this.contentId="",this.isSnoozed=!1,this.reportReason="",this.pubsub=new m(this),this.onPostUpdateAction=t=>{if(t.postId!==this.contentId)return;const{action:e}=t;switch(e){case s.snoozeReporter:this.isSnoozed=!0;break;case s.unsnoozeReporter:this.isSnoozed=!1}},this.onCommentUpdateAction=t=>{if(t.commentId!==this.contentId)return;const{action:e}=t;switch(e){case o.snoozeReporter:this.isSnoozed=!0;break;case o.unsnoozeReporter:this.isSnoozed=!1}}}connectedCallback(){super.connectedCallback(),b(this.contentId)?this.pubsub.subscribe(n.PostUpdated,this.onPostUpdateAction):this.pubsub.subscribe(n.CommentUpdated,this.onCommentUpdateAction)}disconnectedCallback(){super.disconnectedCallback(),b(this.contentId)?this.pubsub.unsubscribe(n.PostUpdated,this.onPostUpdateAction):this.pubsub.unsubscribe(n.CommentUpdated,this.onCommentUpdateAction)}renderReportOverflowMenu(){return i`\n <faceplate-dropdown-menu @click="${t=>t.stopPropagation()}" position="bottom-end">\n ${g({appearance:"plain",size:z.ExtraSmall,children:S({size:y.ExtraSmall})})}\n <faceplate-menu slot="menu">\n ${k({label:this.isSnoozed?"Un-snooze reporter":"Snooze reporter",description:this.isSnoozed?"Receive reports from this user again":"Pause reports from this user for 7 days",leadingIcon:P({size:y.Small}),onClick:this.toggleSnooze})}\n </faceplate-menu>\n </faceplate-dropdown-menu>\n `}sendTrackingEvent(t,e,s){const o=s?"snoozereports":"unsnoozereports",n=b(t)?"post":"comment",a=b(t)?t:null,i=b(t)?null:t,r=v({source:"moderator",action:o,noun:n},{...a&&{post:{id:a}},...i&&{comment:{id:i}},...e&&{action_info:{reason:e}}});this.trackEvent(r)}showToast({success:t,isSnoozed:e}){const s=t?e?"Reports from these users will be paused":"Reports from these users will be resumed":"Failed to update reports",o=t?I.info:I.error,n=f("faceplate-alert",{level:o,message:s});this.dispatchEvent(n)}async updateReportState(t){try{const{data:e}=await R({operation:U.UpdateReportState,variables:{input:{itemId:this.contentId,reportText:this.reportReason,isSnoozed:t}}});return e?.updateReport?.ok??!1}catch(t){return!1}}async toggleSnooze(t){const e=!this.isSnoozed;this.sendTrackingEvent(this.contentId,this.reportReason,e);const a=await this.updateReportState(e);a&&(e?b(this.contentId)?this.pubsub.publish(n.PostUpdated,{postId:this.contentId,action:s.snoozeReporter,value:!0}):this.pubsub.publish(n.CommentUpdated,{commentId:this.contentId,action:o.snoozeReporter,value:!0}):b(this.contentId)?this.pubsub.publish(n.PostUpdated,{postId:this.contentId,action:s.unsnoozeReporter,value:!0}):this.pubsub.publish(n.CommentUpdated,{commentId:this.contentId,action:o.unsnoozeReporter,value:!0})),this.showToast({success:a,isSnoozed:this.isSnoozed})}render(){const t={"flex items-center m-0 p-0":!0,"bg-secondary-background":this.isSnoozed};return i`<li class="${C(t)}">\n <slot \n name="${w(this.isSnoozed?"snoozed":void 0)}" \n class="flex-auto block" \n></slot>\n ${this.renderReportOverflowMenu()}\n </li> `}};A.styles=[d],c([p({type:String,attribute:"content-id"})],A.prototype,"contentId",void 0),c([p({type:Boolean,attribute:"is-snoozed"})],A.prototype,"isSnoozed",void 0),c([p({type:String,attribute:"report-reason"})],A.prototype,"reportReason",void 0),A=c([l("user-report-summary")],A);
//# sourceMappingURL=mod-content-state-indicators-client-js-eb7041bf.js.map
